  <!DOCTYPE html>
  <html>
  <head>
    <title>Motifs map</title>
    <script type="module" src="index.js"></script>
    <script src='https://unpkg.com/maplibre-gl@3.0.1/dist/maplibre-gl.js'></script>
    <link href='https://unpkg.com/maplibre-gl@3.0.1/dist/maplibre-gl.css' rel='stylesheet' />
    <link rel="stylesheet" type="text/css" href="./style.css" />
  </head>
<body>
<div id="map"></div>
<div id="legend"></div>
<div id="active_countries"></div>

<script type="module">
import LibClass from "./index.js"
// console.log(1);
var map = new maplibregl.Map({
  container: 'map'
  ,style: './style.json' // stylesheet location
  ,center: [40, 40] // starting position [lng, lat]
  ,zoom: 2 // starting zoom
  ,maxZoom: 8
});
var lib = new LibClass(map);

map.on("load",function(e){
  console.log(2);
    for ( const f of map.querySourceFeatures("maplibre",{sourceLayer:"countries"}) ){
      if (lib.ccode2lang[f.properties.ADM0_A3]) {
        lib.ccode2feature[f.properties.ADM0_A3] = {id:f.id,source:"maplibre",sourceLayer:"countries"};
        map.setFeatureState(lib.ccode2feature[f.properties.ADM0_A3], {"state":"deselected"});
        //console.log(f.properties.NAME);
      } else {
        //console.log(f.properties.NAME);
      }
    }
  }
);
// map.on('click', function(e) {
// console.log(e);
// var f = map.queryRenderedFeatures(e.point, { layers: ['countries-fill'] });
// console.log(f);
// var fs = map.getFeatureState({id:f[0].id,source:"maplibre",sourceLayer:"countries"});
// console.log(fs);
// if (fs["state"])
//   map.setFeatureState({id:f[0].id,source:"maplibre",sourceLayer:"countries"}, {"state": fs["state"] == "selected" ? "deselected" : "selected"});
// });
//console.log(map.getStyle())
</script>
</body>
</html>